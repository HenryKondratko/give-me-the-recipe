{"ast":null,"code":"/**\n * Copyright 2019 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __classPrivateFieldSet = this && this.__classPrivateFieldSet || function (receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value), value;\n};\nvar __classPrivateFieldGet = this && this.__classPrivateFieldGet || function (receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _LifecycleWatcher_instances, _LifecycleWatcher_expectedLifecycle, _LifecycleWatcher_frameManager, _LifecycleWatcher_frame, _LifecycleWatcher_timeout, _LifecycleWatcher_navigationRequest, _LifecycleWatcher_eventListeners, _LifecycleWatcher_initialLoaderId, _LifecycleWatcher_sameDocumentNavigationCompleteCallback, _LifecycleWatcher_sameDocumentNavigationPromise, _LifecycleWatcher_lifecycleCallback, _LifecycleWatcher_lifecyclePromise, _LifecycleWatcher_newDocumentNavigationCompleteCallback, _LifecycleWatcher_newDocumentNavigationPromise, _LifecycleWatcher_terminationCallback, _LifecycleWatcher_terminationPromise, _LifecycleWatcher_timeoutPromise, _LifecycleWatcher_maximumTimer, _LifecycleWatcher_hasSameDocumentNavigation, _LifecycleWatcher_swapped, _LifecycleWatcher_navigationResponseReceived, _LifecycleWatcher_onRequest, _LifecycleWatcher_onRequestFailed, _LifecycleWatcher_onResponse, _LifecycleWatcher_onFrameDetached, _LifecycleWatcher_terminate, _LifecycleWatcher_createTimeoutPromise, _LifecycleWatcher_navigatedWithinDocument, _LifecycleWatcher_navigated, _LifecycleWatcher_frameSwapped, _LifecycleWatcher_checkLifecycleComplete;\nimport { assert } from '../util/assert.js';\nimport { createDeferredPromise } from '../util/DeferredPromise.js';\nimport { CDPSessionEmittedEvents } from './Connection.js';\nimport { TimeoutError } from './Errors.js';\nimport { FrameManagerEmittedEvents } from './FrameManager.js';\nimport { NetworkManagerEmittedEvents } from './NetworkManager.js';\nimport { addEventListener, removeEventListeners } from './util.js';\nconst puppeteerToProtocolLifecycle = new Map([['load', 'load'], ['domcontentloaded', 'DOMContentLoaded'], ['networkidle0', 'networkIdle'], ['networkidle2', 'networkAlmostIdle']]);\nconst noop = () => {};\n/**\n * @internal\n */\nexport class LifecycleWatcher {\n  constructor(frameManager, frame, waitUntil, timeout) {\n    _LifecycleWatcher_instances.add(this);\n    _LifecycleWatcher_expectedLifecycle.set(this, void 0);\n    _LifecycleWatcher_frameManager.set(this, void 0);\n    _LifecycleWatcher_frame.set(this, void 0);\n    _LifecycleWatcher_timeout.set(this, void 0);\n    _LifecycleWatcher_navigationRequest.set(this, null);\n    _LifecycleWatcher_eventListeners.set(this, void 0);\n    _LifecycleWatcher_initialLoaderId.set(this, void 0);\n    _LifecycleWatcher_sameDocumentNavigationCompleteCallback.set(this, noop);\n    _LifecycleWatcher_sameDocumentNavigationPromise.set(this, new Promise(fulfill => {\n      __classPrivateFieldSet(this, _LifecycleWatcher_sameDocumentNavigationCompleteCallback, fulfill, \"f\");\n    }));\n    _LifecycleWatcher_lifecycleCallback.set(this, noop);\n    _LifecycleWatcher_lifecyclePromise.set(this, new Promise(fulfill => {\n      __classPrivateFieldSet(this, _LifecycleWatcher_lifecycleCallback, fulfill, \"f\");\n    }));\n    _LifecycleWatcher_newDocumentNavigationCompleteCallback.set(this, noop);\n    _LifecycleWatcher_newDocumentNavigationPromise.set(this, new Promise(fulfill => {\n      __classPrivateFieldSet(this, _LifecycleWatcher_newDocumentNavigationCompleteCallback, fulfill, \"f\");\n    }));\n    _LifecycleWatcher_terminationCallback.set(this, noop);\n    _LifecycleWatcher_terminationPromise.set(this, new Promise(fulfill => {\n      __classPrivateFieldSet(this, _LifecycleWatcher_terminationCallback, fulfill, \"f\");\n    }));\n    _LifecycleWatcher_timeoutPromise.set(this, void 0);\n    _LifecycleWatcher_maximumTimer.set(this, void 0);\n    _LifecycleWatcher_hasSameDocumentNavigation.set(this, void 0);\n    _LifecycleWatcher_swapped.set(this, void 0);\n    _LifecycleWatcher_navigationResponseReceived.set(this, void 0);\n    if (Array.isArray(waitUntil)) {\n      waitUntil = waitUntil.slice();\n    } else if (typeof waitUntil === 'string') {\n      waitUntil = [waitUntil];\n    }\n    __classPrivateFieldSet(this, _LifecycleWatcher_initialLoaderId, frame._loaderId, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_expectedLifecycle, waitUntil.map(value => {\n      const protocolEvent = puppeteerToProtocolLifecycle.get(value);\n      assert(protocolEvent, 'Unknown value for options.waitUntil: ' + value);\n      return protocolEvent;\n    }), \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_frameManager, frameManager, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_frame, frame, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_timeout, timeout, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_eventListeners, [addEventListener(frameManager.client, CDPSessionEmittedEvents.Disconnected, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_terminate).bind(this, new Error('Navigation failed because browser has disconnected!'))), addEventListener(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManagerEmittedEvents.LifecycleEvent, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).bind(this)), addEventListener(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManagerEmittedEvents.FrameNavigatedWithinDocument, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_navigatedWithinDocument).bind(this)), addEventListener(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManagerEmittedEvents.FrameNavigated, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_navigated).bind(this)), addEventListener(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManagerEmittedEvents.FrameSwapped, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_frameSwapped).bind(this)), addEventListener(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManagerEmittedEvents.FrameDetached, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_onFrameDetached).bind(this)), addEventListener(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\").networkManager, NetworkManagerEmittedEvents.Request, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_onRequest).bind(this)), addEventListener(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\").networkManager, NetworkManagerEmittedEvents.Response, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_onResponse).bind(this)), addEventListener(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\").networkManager, NetworkManagerEmittedEvents.RequestFailed, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_onRequestFailed).bind(this))], \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_timeoutPromise, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_createTimeoutPromise).call(this), \"f\");\n    __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n  }\n  async navigationResponse() {\n    var _a;\n    // Continue with a possibly null response.\n    await ((_a = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _a === void 0 ? void 0 : _a.catch(() => {}));\n    return __classPrivateFieldGet(this, _LifecycleWatcher_navigationRequest, \"f\") ? __classPrivateFieldGet(this, _LifecycleWatcher_navigationRequest, \"f\").response() : null;\n  }\n  sameDocumentNavigationPromise() {\n    return __classPrivateFieldGet(this, _LifecycleWatcher_sameDocumentNavigationPromise, \"f\");\n  }\n  newDocumentNavigationPromise() {\n    return __classPrivateFieldGet(this, _LifecycleWatcher_newDocumentNavigationPromise, \"f\");\n  }\n  lifecyclePromise() {\n    return __classPrivateFieldGet(this, _LifecycleWatcher_lifecyclePromise, \"f\");\n  }\n  timeoutOrTerminationPromise() {\n    return Promise.race([__classPrivateFieldGet(this, _LifecycleWatcher_timeoutPromise, \"f\"), __classPrivateFieldGet(this, _LifecycleWatcher_terminationPromise, \"f\")]);\n  }\n  dispose() {\n    removeEventListeners(__classPrivateFieldGet(this, _LifecycleWatcher_eventListeners, \"f\"));\n    __classPrivateFieldGet(this, _LifecycleWatcher_maximumTimer, \"f\") !== undefined && clearTimeout(__classPrivateFieldGet(this, _LifecycleWatcher_maximumTimer, \"f\"));\n  }\n}\n_LifecycleWatcher_expectedLifecycle = new WeakMap(), _LifecycleWatcher_frameManager = new WeakMap(), _LifecycleWatcher_frame = new WeakMap(), _LifecycleWatcher_timeout = new WeakMap(), _LifecycleWatcher_navigationRequest = new WeakMap(), _LifecycleWatcher_eventListeners = new WeakMap(), _LifecycleWatcher_initialLoaderId = new WeakMap(), _LifecycleWatcher_sameDocumentNavigationCompleteCallback = new WeakMap(), _LifecycleWatcher_sameDocumentNavigationPromise = new WeakMap(), _LifecycleWatcher_lifecycleCallback = new WeakMap(), _LifecycleWatcher_lifecyclePromise = new WeakMap(), _LifecycleWatcher_newDocumentNavigationCompleteCallback = new WeakMap(), _LifecycleWatcher_newDocumentNavigationPromise = new WeakMap(), _LifecycleWatcher_terminationCallback = new WeakMap(), _LifecycleWatcher_terminationPromise = new WeakMap(), _LifecycleWatcher_timeoutPromise = new WeakMap(), _LifecycleWatcher_maximumTimer = new WeakMap(), _LifecycleWatcher_hasSameDocumentNavigation = new WeakMap(), _LifecycleWatcher_swapped = new WeakMap(), _LifecycleWatcher_navigationResponseReceived = new WeakMap(), _LifecycleWatcher_instances = new WeakSet(), _LifecycleWatcher_onRequest = function _LifecycleWatcher_onRequest(request) {\n  var _a, _b;\n  if (request.frame() !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\") || !request.isNavigationRequest()) {\n    return;\n  }\n  __classPrivateFieldSet(this, _LifecycleWatcher_navigationRequest, request, \"f\");\n  // Resolve previous navigation response in case there are multiple\n  // navigation requests reported by the backend. This generally should not\n  // happen by it looks like it's possible.\n  (_a = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _a === void 0 ? void 0 : _a.resolve();\n  __classPrivateFieldSet(this, _LifecycleWatcher_navigationResponseReceived, createDeferredPromise(), \"f\");\n  if (request.response() !== null) {\n    (_b = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _b === void 0 ? void 0 : _b.resolve();\n  }\n}, _LifecycleWatcher_onRequestFailed = function _LifecycleWatcher_onRequestFailed(request) {\n  var _a, _b;\n  if (((_a = __classPrivateFieldGet(this, _LifecycleWatcher_navigationRequest, \"f\")) === null || _a === void 0 ? void 0 : _a._requestId) !== request._requestId) {\n    return;\n  }\n  (_b = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _b === void 0 ? void 0 : _b.resolve();\n}, _LifecycleWatcher_onResponse = function _LifecycleWatcher_onResponse(response) {\n  var _a, _b;\n  if (((_a = __classPrivateFieldGet(this, _LifecycleWatcher_navigationRequest, \"f\")) === null || _a === void 0 ? void 0 : _a._requestId) !== response.request()._requestId) {\n    return;\n  }\n  (_b = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _b === void 0 ? void 0 : _b.resolve();\n}, _LifecycleWatcher_onFrameDetached = function _LifecycleWatcher_onFrameDetached(frame) {\n  if (__classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\") === frame) {\n    __classPrivateFieldGet(this, _LifecycleWatcher_terminationCallback, \"f\").call(null, new Error('Navigating frame was detached'));\n    return;\n  }\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_terminate = function _LifecycleWatcher_terminate(error) {\n  __classPrivateFieldGet(this, _LifecycleWatcher_terminationCallback, \"f\").call(null, error);\n}, _LifecycleWatcher_createTimeoutPromise = async function _LifecycleWatcher_createTimeoutPromise() {\n  if (!__classPrivateFieldGet(this, _LifecycleWatcher_timeout, \"f\")) {\n    return new Promise(noop);\n  }\n  const errorMessage = 'Navigation timeout of ' + __classPrivateFieldGet(this, _LifecycleWatcher_timeout, \"f\") + ' ms exceeded';\n  await new Promise(fulfill => {\n    return __classPrivateFieldSet(this, _LifecycleWatcher_maximumTimer, setTimeout(fulfill, __classPrivateFieldGet(this, _LifecycleWatcher_timeout, \"f\")), \"f\");\n  });\n  return new TimeoutError(errorMessage);\n}, _LifecycleWatcher_navigatedWithinDocument = function _LifecycleWatcher_navigatedWithinDocument(frame) {\n  if (frame !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")) {\n    return;\n  }\n  __classPrivateFieldSet(this, _LifecycleWatcher_hasSameDocumentNavigation, true, \"f\");\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_navigated = function _LifecycleWatcher_navigated(frame) {\n  if (frame !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")) {\n    return;\n  }\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_frameSwapped = function _LifecycleWatcher_frameSwapped(frame) {\n  if (frame !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")) {\n    return;\n  }\n  __classPrivateFieldSet(this, _LifecycleWatcher_swapped, true, \"f\");\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_checkLifecycleComplete = function _LifecycleWatcher_checkLifecycleComplete() {\n  // We expect navigation to commit.\n  if (!checkLifecycle(__classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\"), __classPrivateFieldGet(this, _LifecycleWatcher_expectedLifecycle, \"f\"))) {\n    return;\n  }\n  __classPrivateFieldGet(this, _LifecycleWatcher_lifecycleCallback, \"f\").call(this);\n  if (__classPrivateFieldGet(this, _LifecycleWatcher_hasSameDocumentNavigation, \"f\")) {\n    __classPrivateFieldGet(this, _LifecycleWatcher_sameDocumentNavigationCompleteCallback, \"f\").call(this);\n  }\n  if (__classPrivateFieldGet(this, _LifecycleWatcher_swapped, \"f\") || __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")._loaderId !== __classPrivateFieldGet(this, _LifecycleWatcher_initialLoaderId, \"f\")) {\n    __classPrivateFieldGet(this, _LifecycleWatcher_newDocumentNavigationCompleteCallback, \"f\").call(this);\n  }\n  function checkLifecycle(frame, expectedLifecycle) {\n    for (const event of expectedLifecycle) {\n      if (!frame._lifecycleEvents.has(event)) {\n        return false;\n      }\n    }\n    for (const child of frame.childFrames()) {\n      if (child._hasStartedLoading && !checkLifecycle(child, expectedLifecycle)) {\n        return false;\n      }\n    }\n    return true;\n  }\n};","map":{"version":3,"names":["assert","createDeferredPromise","CDPSessionEmittedEvents","TimeoutError","FrameManagerEmittedEvents","NetworkManagerEmittedEvents","addEventListener","removeEventListeners","puppeteerToProtocolLifecycle","Map","noop","LifecycleWatcher","constructor","frameManager","frame","waitUntil","timeout","_LifecycleWatcher_expectedLifecycle","set","_LifecycleWatcher_frameManager","_LifecycleWatcher_frame","_LifecycleWatcher_timeout","_LifecycleWatcher_navigationRequest","_LifecycleWatcher_eventListeners","_LifecycleWatcher_initialLoaderId","_LifecycleWatcher_sameDocumentNavigationCompleteCallback","_LifecycleWatcher_sameDocumentNavigationPromise","Promise","fulfill","__classPrivateFieldSet","_LifecycleWatcher_lifecycleCallback","_LifecycleWatcher_lifecyclePromise","_LifecycleWatcher_newDocumentNavigationCompleteCallback","_LifecycleWatcher_newDocumentNavigationPromise","_LifecycleWatcher_terminationCallback","_LifecycleWatcher_terminationPromise","_LifecycleWatcher_timeoutPromise","_LifecycleWatcher_maximumTimer","_LifecycleWatcher_hasSameDocumentNavigation","_LifecycleWatcher_swapped","_LifecycleWatcher_navigationResponseReceived","Array","isArray","slice","_loaderId","map","value","protocolEvent","get","client","Disconnected","__classPrivateFieldGet","_LifecycleWatcher_instances","_LifecycleWatcher_terminate","bind","Error","LifecycleEvent","_LifecycleWatcher_checkLifecycleComplete","FrameNavigatedWithinDocument","_LifecycleWatcher_navigatedWithinDocument","FrameNavigated","_LifecycleWatcher_navigated","FrameSwapped","_LifecycleWatcher_frameSwapped","FrameDetached","_LifecycleWatcher_onFrameDetached","networkManager","Request","_LifecycleWatcher_onRequest","Response","_LifecycleWatcher_onResponse","RequestFailed","_LifecycleWatcher_onRequestFailed","_LifecycleWatcher_createTimeoutPromise","call","navigationResponse","_a","catch","response","sameDocumentNavigationPromise","newDocumentNavigationPromise","lifecyclePromise","timeoutOrTerminationPromise","race","dispose","undefined","clearTimeout","request","isNavigationRequest","resolve","_b","_requestId","error","errorMessage","setTimeout","checkLifecycle","expectedLifecycle","event","_lifecycleEvents","has","child","childFrames","_hasStartedLoading"],"sources":["../../../../src/common/LifecycleWatcher.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}